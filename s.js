{let c=chrome,n=c.webNavigation,b=n.onBeforeNavigate,m=n.onCommitted,p=c.action,s=c.storage.local,a=()=>(b.addListener(f,{url:[{urlSuffix:"ie=UTF-8"}]}),m.removeListener(a)),f=v=>(b.removeListener(f),m.addListener(a),c.tabs.update({url:v.url.slice(0,v.url.indexOf("&",33))})),x,t=()=>c.declarativeNetRequest.updateEnabledRulesets(x?(p.setIcon({path:"off.png"}),b.removeListener(f),m.removeListener(a),s.set({0:1}),x=0,{disableRulesetIds:["0"]}):(p.setIcon({path:"on.png"}),a(),s.set({0:0}),x=1,{enableRulesetIds:["0"]}));s.get("0").then(v=>(x=v[0],p.onClicked.addListener(t),t()))}