{let c=chrome,n=c.webNavigation,b=n.onBeforeNavigate,m=n.onCommitted,p=c.action,s=c.storage.local,a=()=>(b.addListener(f,{url:[{hostEquals:"www.google.com",queryContains:"?q="}]}),m.removeListener(a)),f=v=>{b.removeListener(f),m.addListener(a),v=new URL(v.url);let i=3;while(v.searchParams.delete(["gs_lcrp","ie","sourceid"][--i]),i);c.tabs.update({url:v.href})},x,t=()=>c.declarativeNetRequest.updateEnabledRulesets(x?(p.setIcon({path:"off.png"}),b.removeListener(f),m.removeListener(a),s.set({0:1}),x=0,{disableRulesetIds:["0"]}):(p.setIcon({path:"on.png"}),s.set({0:0}),x=1,{enableRulesetIds:["0"]}));s.get("0").then(v=>(x=v[0],p.onClicked.addListener(t),t()))}